function [x, kickx, polynomb] = sirius_si_pmm_kick

fit_monomials = [2,3,4,5,6,7,8,9,10];

data = [ ...
% posx[mm] kickx[mrad]
-12.0,  -0.657079951;
-11.5,  -0.865582259;
-11.0,	-1.09881377;
-10.5,	-1.354283777;
-10.0,	-1.614405125;
-9.5,	-1.855570145;
-9.0,   -2.054455434;
-8.5,	-2.192068498;
-8.0,   -2.25599353;
-7.5,	-2.241240604;
-7.0,   -2.1500524;
-6.5,	-1.990975131;
-6.0,   -1.777455771;
-5.5,	-1.526185841;
-5.0,   -1.255372967;
-4.5,	-0.983085183;
-4.0,   -0.725779496;
-3.5,	-0.497095558;
-3.0,   -0.30696738;
-2.5,	-0.161080987;
-2.0,   -0.060683531;
-1.5,	-0.002729931;
-1.0,    0.019663676;
-0.5,    0.016504288;
 0.0,    0;
 0.5,	-0.016504288;
 1.0,   -0.019663676;
 1.5,	 0.002729931;
 2.0,    0.060683531;
 2.5,	 0.161080987;
 3.0,    0.30696738;
 3.5,	 0.497095558;
 4.0,    0.725779496;
 4.5,	 0.983085183;
 5.0,    1.255372967;
 5.5,	 1.526185841;
 6.0,    1.777455771;
 6.5,	 1.990975131;
 7.0,    2.1500524;
 7.5,	 2.241240604;
 8.0,    2.25599353;
 8.5,	 2.192068498;
 9.0,    2.054455434;
 9.5,	 1.855570145;
 10.0,   1.614405125;
 10.5,	 1.354283777;
 11.0,   1.09881377;
 11.5,	 0.865582259;
 12.0,   0.657079951];

x = data(:,1)*0.001;
kickx = data(:,2)*0.001;

[coeffs, fit_kickx] = lnls_polyfit(x, kickx, fit_monomials);
figure; hold all; plot(x, kickx); plot(x,fit_kickx);


polynomb = zeros(1,1+max(fit_monomials));
polynomb(1+fit_monomials) = coeffs;
