function epu_field_data = lnls1_epu_read_field_measurements



%% CAMPOS DAS ESTRUTURAS NO ARRAY
%  ==============================
p.gap_upstream   = 0;
p.gap_downstream = 0;
p.phase_csd      = 0;
p.phase_cie      = 0;
p.files = {};
epu_field_data = p;
epu_field_data(1) = [];


%% CONFIGURAÇÕES EM FASE
%  =====================

p.gap_upstream   = 22;
p.gap_downstream = 22;
p.phase_csd      = 0;
p.phase_cie      = 0;
p.files = { ...
    'polarizacao horizontal 00mm/Map0802_Bx_Gap22_Fase0.0_01_X=0_Real.dat', ...
    'polarizacao horizontal 00mm/Map1202_By_Gap22_Fase0.0_01_X=0_Real.dat', ...
    'polarizacao horizontal 00mm/Map0802_Bz_Gap22_Fase0.0_01_X=0_Real.dat', ...
    };
epu_field_data(end+1) = p;

p.gap_upstream   = 25.7;
p.gap_downstream = 25.7;
p.phase_csd      = 0;
p.phase_cie      = 0;
p.files = { ...
    'polarizacao horizontal 00mm/Map1902_Bx_Gap25.7_Fase0.0_01_Real.dat', ...
    'polarizacao horizontal 00mm/Map1902_By_Gap25.7_Fase0.0_01_Real.dat', ...
    'polarizacao horizontal 00mm/Map1902_Bz_Gap25.7_Fase0.0_01_Real.dat', ...
    };
epu_field_data(end+1) = p;

p.gap_upstream   = 29.3;
p.gap_downstream = 29.3;
p.phase_csd      = 0;
p.phase_cie      = 0;
p.files = { ...
    'polarizacao horizontal 00mm/Map1902_Bx_Gap29.3_Fase0.0_01_Real.dat', ...
    'polarizacao horizontal 00mm/Map1902_By_Gap29.3_Fase0.0_01_Real.dat', ...
    'polarizacao horizontal 00mm/Map1902_Bz_Gap29.3_Fase0.0_01_Real.dat', ...
    };
epu_field_data(end+1) = p;

p.gap_upstream   = 40.9;
p.gap_downstream = 40.9;
p.phase_csd      = 0;
p.phase_cie      = 0;
p.files = { ...
    'polarizacao horizontal 00mm/Map1902_Bx_Gap40.9_Fase0.0_01_Real.dat', ...
    'polarizacao horizontal 00mm/Map1902_By_Gap40.9_Fase0.0_01_Real.dat', ...
    'polarizacao horizontal 00mm/Map1902_Bz_Gap40.9_Fase0.0_01_Real.dat', ...
    };    
epu_field_data(end+1) = p;

p.gap_upstream   = 31;
p.gap_downstream = 31;
p.phase_csd      = 10.5;
p.phase_cie      = 10.5;
p.files = { ...
    'polarizacao eliptica +10.5mm/Map1902_Bx_Gap31.0_Fase10.5_01_Real.dat', ...
    'polarizacao eliptica +10.5mm/Map1902_By_Gap31.0_Fase10.5_01_Real.dat', ...
    'polarizacao eliptica +10.5mm/Map1902_Bz_Gap31.0_Fase10.5_01_Real.dat', ...
    }; 
epu_field_data(end+1) = p;

p.gap_upstream   = 35.7;
p.gap_downstream = 35.7;
p.phase_csd      = 10.5;
p.phase_cie      = 10.5;
p.files = { ...
    'polarizacao eliptica +10.5mm/Map2102_Bx_Gap35.7_Fase10.5_01_Real.dat', ...
    'polarizacao eliptica +10.5mm/Map2102_By_Gap35.7_Fase10.5_01_Real.dat', ...
    'polarizacao eliptica +10.5mm/Map2102_Bz_Gap35.7_Fase10.5_01_Real.dat', ...
    };
epu_field_data(end+1) = p;

p.gap_upstream   = 38.7;
p.gap_downstream = 38.7;
p.phase_csd      = 10.5;
p.phase_cie      = 10.5;
p.files = { ...
    'polarizacao eliptica +10.5mm/Map2102_Bx_Gap38.7_Fase10.5_01_Real.dat', ...
    'polarizacao eliptica +10.5mm/Map2102_By_Gap38.7_Fase10.5_01_Real.dat', ...
    'polarizacao eliptica +10.5mm/Map2102_Bz_Gap38.7_Fase10.5_01_Real.dat', ...
    };
epu_field_data(end+1) = p;

p.gap_upstream   = 22;
p.gap_downstream = 22;
p.phase_csd      = 16.39;
p.phase_cie      = 16.39;
p.files = { ...
    'polarizacao circular +16.39mm/Map1202_Bx_Gap22_Fase16.39_01_X=0_Real.dat', ...
    'polarizacao circular +16.39mm/Map1302_By_Gap22_Fase16.39_01_X=0_Real.dat', ...
    'polarizacao circular +16.39mm/Map1202_Bz_Gap22_Fase16.39_01_X=0_Real.dat', ...
    };
epu_field_data(end+1) = p;

p.gap_upstream   = 22;
p.gap_downstream = 22;
p.phase_csd      = 25;
p.phase_cie      = 25;
p.files = { ...
    'polarizacao vertical +25mm/Map0902_Bx_Gap22_Fase25.0_01_X=0_Real.dat', ...
    'polarizacao vertical +25mm/Map1302_By_Gap22_Fase25.0_01_X=0_Real.dat', ...
    'polarizacao vertical +25mm/Map0902_Bz_Gap22_Fase25.0_01_X=0_Real.dat', ...
    };  
epu_field_data(end+1) = p;

p.gap_upstream   = 23.3;
p.gap_downstream = 23.3;
p.phase_csd      = 25;
p.phase_cie      = 25;
p.files = { ...
    'polarizacao vertical +25mm/Map1902_Bx_Gap23.3_Fase25.0_01_Real.dat', ...
    'polarizacao vertical +25mm/Map1902_By_Gap23.3_Fase25.0_01_Real.dat', ...
    'polarizacao vertical +25mm/Map1902_Bz_Gap23.3_Fase25.0_01_Real.dat', ...
    };
epu_field_data(end+1) = p;

p.gap_upstream   = 29.2;
p.gap_downstream = 29.2;
p.phase_csd      = 25;
p.phase_cie      = 25;
p.files = { ...
    'polarizacao vertical +25mm/Map1902_Bx_Gap29.2_Fase25.0_01_Real.dat', ...
    'polarizacao vertical +25mm/Map1902_By_Gap29.2_Fase25.0_01_Real.dat', ...
    'polarizacao vertical +25mm/Map1902_Bz_Gap29.2_Fase25.0_01_Real.dat', ...
    };  
epu_field_data(end+1) = p;

p.gap_upstream   = 32.5;
p.gap_downstream = 32.5;
p.phase_csd      = 25;
p.phase_cie      = 25;
p.files = { ...
    'polarizacao vertical +25mm/Map1902_Bx_Gap32.5_Fase25.0_01_Real.dat', ...
    'polarizacao vertical +25mm/Map1902_By_Gap32.5_Fase25.0_01_Real.dat', ...
    'polarizacao vertical +25mm/Map1902_Bz_Gap32.5_Fase25.0_01_Real.dat', ...
    };
epu_field_data(end+1) = p;

p.gap_upstream   = 22;
p.gap_downstream = 22;
p.phase_csd      = -25;
p.phase_cie      = -25;
p.files = { ...
    'polarizacao vertical -25mm/Map1202_Bx_Gap22_Fase-25.0_01_X=0_Real.dat', ...
    'polarizacao vertical -25mm/Map1302_By_Gap22_Fase-25.0_01_X=0_Real.dat', ...
    'polarizacao vertical -25mm/Map1402_Bz_Gap22.0_Fase-25.0_01_X=0_Real.dat', ...
    };
epu_field_data(end+1) = p;

p.gap_upstream   = 23.3;
p.gap_downstream = 23.3;
p.phase_csd      = -25;
p.phase_cie      = -25;
p.files = { ...
    'polarizacao vertical -25mm/Map1902_Bx_Gap23.3_Fase-25.0_01_Real.dat', ...
    'polarizacao vertical -25mm/Map1902_By_Gap23.3_Fase-25.0_01_Real.dat', ...
    'polarizacao vertical -25mm/Map1902_Bz_Gap23.3_Fase-25.0_01_Real.dat', ...
    };
epu_field_data(end+1) = p;

p.gap_upstream   = 29.2;
p.gap_downstream = 29.2;
p.phase_csd      = -25;
p.phase_cie      = -25;
p.files = { ...
    'polarizacao vertical -25mm/Map1902_Bx_Gap29.2_Fase-25.0_01_Real.dat', ...
    'polarizacao vertical -25mm/Map1902_By_Gap29.2_Fase-25.0_01_Real.dat', ...
    'polarizacao vertical -25mm/Map1902_Bz_Gap29.2_Fase-25.0_01_Real.dat', ...
    };
epu_field_data(end+1) = p;

p.gap_upstream   = 32.5;
p.gap_downstream = 32.5;
p.phase_csd      = -25;
p.phase_cie      = -25;
p.files = { ...
    'polarizacao vertical -25mm/Map1902_Bx_Gap32.5_Fase-25.0_01_Real.dat', ...
    'polarizacao vertical -25mm/Map1902_By_Gap32.5_Fase-25.0_01_Real.dat', ...
    'polarizacao vertical -25mm/Map1902_Bz_Gap32.5_Fase-25.0_01_Real.dat', ...
    };
epu_field_data(end+1) = p;

p.gap_upstream   = 22.0;
p.gap_downstream = 22.0;
p.phase_csd      = -16.39;
p.phase_cie      = -16.39;
p.files = { ...
    'polarizacao circular -16.39mm/Map1402_Bx_Gap22_Fase-16.39_01_X=0_Real.dat', ...
    'polarizacao circular -16.39mm/Map1302_By_Gap22_Fase-16.39_01_X=0_Real.dat', ...
    'polarizacao circular -16.39mm/Map1402_Bz_Gap22_Fase-16.39_01_X=0_Real.dat', ...
    };
epu_field_data(end+1) = p;

p.gap_upstream   = 31;
p.gap_downstream = 31;
p.phase_csd      = -10.5;
p.phase_cie      = -10.5;
p.files = { ...
    'polarizacao eliptica -10.5mm/Map1902_Bx_Gap31.0_Fase-10.5_01_Real.dat', ...
    'polarizacao eliptica -10.5mm/Map1902_By_Gap31.0_Fase-10.5_01_Real.dat', ...
    'polarizacao eliptica -10.5mm/Map1902_Bz_Gap31.0_Fase-10.5_01_Real.dat', ...
    };
epu_field_data(end+1) = p;

p.gap_upstream   = 35.7;
p.gap_downstream = 35.7;
p.phase_csd      = -10.5;
p.phase_cie      = -10.5;
p.files = { ...
    'polarizacao eliptica -10.5mm/Map1902_Bx_Gap35.7_Fase-10.5_01_Real.dat', ...
    'polarizacao eliptica -10.5mm/Map1902_By_Gap35.7_Fase-10.5_01_Real.dat', ...
    'polarizacao eliptica -10.5mm/Map1902_Bz_Gap35.7_Fase-10.5_01_Real.dat', ...
    };
epu_field_data(end+1) = p;

p.gap_upstream   = 38.7;
p.gap_downstream = 38.7;
p.phase_csd      = -10.5;
p.phase_cie      = -10.5;
p.files = { ...
    'polarizacao eliptica -10.5mm/Map2102_Bx_Gap38.7_Fase-10.5_01_Real.dat', ...
    'polarizacao eliptica -10.5mm/Map2102_By_Gap38.7_Fase-10.5_01_Real.dat', ...
    'polarizacao eliptica -10.5mm/Map2102_Bz_Gap38.7_Fase-10.5_01_Real.dat', ...
    };
epu_field_data(end+1) = p;


%% CONFIGURAÇÕES EM CONTRA-FASE
%  ============================

p.gap_upstream   = 22.7;
p.gap_downstream = 22.7;
p.phase_csd      = 13.55;
p.phase_cie      = -13.55;
p.files = { ...
    'polarizacao angulo magico +13.55mm/Map1502_Bx_Gap22.7_ContraFase13.55_01_X=0_Real.dat', ...
    'polarizacao angulo magico +13.55mm/Map1502_By_Gap22.7_ContraFase13.55_01_X=0_Real.dat', ...
    'polarizacao angulo magico +13.55mm/Map1502_Bz_Gap22.7_ContraFase13.55_01_X=0_Real.dat', ...
    }; 
epu_field_data(end+1) = p;

p.gap_upstream   = 28.7;
p.gap_downstream = 28.7;
p.phase_csd      = 13.55;
p.phase_cie      = -13.55;
p.files = { ...
    'polarizacao angulo magico +13.55mm/Map2102_Bx_Gap28.7_ContraFase13.55_01_Real.dat', ...
    'polarizacao angulo magico +13.55mm/Map2102_By_Gap28.7_ContraFase13.55_01_Real.dat', ...
    'polarizacao angulo magico +13.55mm/Map2102_Bz_Gap28.7_ContraFase13.55_01_Real.dat', ...
    };
epu_field_data(end+1) = p;

p.gap_upstream   = 31.9;
p.gap_downstream = 31.9;
p.phase_csd      = 13.55;
p.phase_cie      = -13.55;
p.files = { ...
    'polarizacao angulo magico +13.55mm/Map2102_Bx_Gap31.9_ContraFase13.55_01_Real.dat', ...
    'polarizacao angulo magico +13.55mm/Map2102_By_Gap31.9_ContraFase13.55_01_Real.dat', ...
    'polarizacao angulo magico +13.55mm/Map2102_Bz_Gap31.9_ContraFase13.55_01_Real.dat', ...
    };
epu_field_data(end+1) = p;


%% lê dados dos arquivos

[pathstr, ~, ~] = fileparts(mfilename('fullpath'));
for i=1:length(epu_field_data)
    epu_field_data(i).files{1} = fullfile(pathstr, 'measurement_data', epu_field_data(i).files{1});
    epu_field_data(i).files{2} = fullfile(pathstr, 'measurement_data', epu_field_data(i).files{2});
    epu_field_data(i).files{3} = fullfile(pathstr, 'measurement_data', epu_field_data(i).files{3});
    epu_field_data(i).bx = read_data_from_file(epu_field_data(i).files{1});
    epu_field_data(i).by = read_data_from_file(epu_field_data(i).files{2});
    epu_field_data(i).bz = read_data_from_file(epu_field_data(i).files{3});
    epu_field_data(i).bx.file = epu_field_data(i).files{1};
    epu_field_data(i).by.file = epu_field_data(i).files{2};
    epu_field_data(i).bz.file = epu_field_data(i).files{3};
end
epu_field_data = rmfield(epu_field_data, 'files');

setappdata(0, 'EPU_FIELD_DATA', epu_field_data);


function r = read_data_from_file(file_name)

data  = importdata(file_name);
r.pos.data   = data.data(:,1);             % units: mm
r.field.data = data.data(:,2)/10000;        % units: T

r.pos.data   = r.pos.data(:);      % garante formato coluna.
r.field.data = r.field.data(:);
