MIME-Version: 1.0
Content-Type: multipart/related; boundary="----=_NextPart_01C781C0.6598B8C0"

This document is a Single File Web Page, also known as a Web Archive file.  If you are seeing this message, your browser or editor doesn't support Web Archive files.  Please download a browser that supports Web Archive, such as Microsoft Internet Explorer.

------=_NextPart_01C781C0.6598B8C0
Content-Location: file:///C:/515444C5/MiddleLayerQuickReference.htm
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html; charset="us-ascii"

<html xmlns:o=3D"urn:schemas-microsoft-com:office:office"
xmlns:w=3D"urn:schemas-microsoft-com:office:word"
xmlns:st1=3D"urn:schemas-microsoft-com:office:smarttags"
xmlns=3D"http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=3DContent-Type content=3D"text/html; charset=3Dus-ascii">
<meta name=3DProgId content=3DWord.Document>
<meta name=3DGenerator content=3D"Microsoft Word 11">
<meta name=3DOriginator content=3D"Microsoft Word 11">
<link rel=3DFile-List href=3D"MiddleLayerQuickReference_files/filelist.xml">
<title>MIDDLE LAYER QUICK REFERENCE</title>
<o:SmartTagType namespaceuri=3D"urn:schemas-microsoft-com:office:smarttags"
 name=3D"place"/>
<o:SmartTagType namespaceuri=3D"urn:schemas-microsoft-com:office:smarttags"
 name=3D"State"/>
<o:SmartTagType namespaceuri=3D"urn:schemas-microsoft-com:office:smarttags"
 name=3D"PlaceType"/>
<o:SmartTagType namespaceuri=3D"urn:schemas-microsoft-com:office:smarttags"
 name=3D"PlaceName"/>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Gregory J. Portmann</o:Author>
  <o:LastAuthor>Gregory J. Portmann</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>1746</o:TotalTime>
  <o:Created>2007-04-18T20:49:00Z</o:Created>
  <o:LastSaved>2007-04-18T20:49:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>2473</o:Words>
  <o:Characters>14098</o:Characters>
  <o:Company>Gregory J. Portmann</o:Company>
  <o:Lines>117</o:Lines>
  <o:Paragraphs>33</o:Paragraphs>
  <o:CharactersWithSpaces>16538</o:CharactersWithSpaces>
  <o:Version>11.6568</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:HideSpellingErrors/>
  <w:HideGrammaticalErrors/>
  <w:ActiveWritingStyle Lang=3D"EN-US" VendorID=3D"64" DLLVersion=3D"131078"
   NLCheck=3D"1">1</w:ActiveWritingStyle>
  <w:ActiveWritingStyle Lang=3D"EN-US" VendorID=3D"64" DLLVersion=3D"131077"
   NLCheck=3D"1">1</w:ActiveWritingStyle>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:SelectEntireFieldWithStartOrEnd/>
   <w:UseWord2002TableStyleRules/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState=3D"false" LatentStyleCount=3D"156">
 </w:LatentStyles>
</xml><![endif]--><!--[if !mso]><object
 classid=3D"clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=3Dieooui></objec=
t>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:16.0pt;
	font-family:Arial;
	mso-font-kerning:16.0pt;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 3.0in right 6.0in;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
 /* Page Definitions */
 @page
	{mso-footnote-separator:url("MiddleLayerQuickReference_files/header.htm") =
fs;
	mso-footnote-continuation-separator:url("MiddleLayerQuickReference_files/h=
eader.htm") fcs;
	mso-endnote-separator:url("MiddleLayerQuickReference_files/header.htm") es;
	mso-endnote-continuation-separator:url("MiddleLayerQuickReference_files/he=
ader.htm") ecs;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-even-footer:url("MiddleLayerQuickReference_files/header.htm") ef1;
	mso-footer:url("MiddleLayerQuickReference_files/header.htm") f1;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:360204391;
	mso-list-type:hybrid;
	mso-list-template-ids:-981838312 67698689 67698713 67698715 67698703 67698=
713 67698715 67698703 67698713 67698715;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l1
	{mso-list-id:444664910;
	mso-list-type:hybrid;
	mso-list-template-ids:2043322850 67698689 67698713 67698715 67698703 67698=
713 67698715 67698703 67698713 67698715;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l2
	{mso-list-id:687102575;
	mso-list-type:hybrid;
	mso-list-template-ids:1634995932 67698689 67698691 67698693 67698689 67698=
691 67698693 67698689 67698691 67698693;}
@list l2:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:63.0pt;
	mso-level-number-position:left;
	margin-left:63.0pt;
	text-indent:-.25in;
	font-family:Symbol;}
@list l3
	{mso-list-id:918172687;
	mso-list-type:hybrid;
	mso-list-template-ids:-524395994 67698703 67698691 67698693 67698689 67698=
691 67698693 67698689 67698691 67698693;}
@list l3:level1
	{mso-level-tab-stop:45.0pt;
	mso-level-number-position:left;
	margin-left:45.0pt;
	text-indent:-.25in;}
@list l3:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.75in;
	mso-level-number-position:left;
	margin-left:1.75in;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l4
	{mso-list-id:1065690371;
	mso-list-type:hybrid;
	mso-list-template-ids:1336187240 67698689 67698713 67698715 67698703 67698=
713 67698715 67698703 67698713 67698715;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:45.0pt;
	mso-level-number-position:left;
	margin-left:45.0pt;
	text-indent:-.25in;
	font-family:Symbol;}
@list l4:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:81.0pt;
	mso-level-number-position:left;
	margin-left:81.0pt;
	text-indent:-.25in;}
@list l4:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:117.0pt;
	mso-level-number-position:right;
	margin-left:117.0pt;
	text-indent:-9.0pt;}
@list l5
	{mso-list-id:1196846972;
	mso-list-type:hybrid;
	mso-list-template-ids:-1973812844 67698689 67698713 67698715 67698703 6769=
8713 67698715 67698703 67698713 67698715;}
@list l5:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l5:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l5:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:1.5in;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l6
	{mso-list-id:1545825365;
	mso-list-type:hybrid;
	mso-list-template-ids:-78734788 67698703 67698713 67698715 67698703 676987=
13 67698715 67698703 67698713 67698715;}
@list l6:level1
	{mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;}
@list l6:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:.75in;
	mso-level-number-position:left;
	margin-left:.75in;
	text-indent:-.25in;}
@list l6:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:1.25in;
	mso-level-number-position:right;
	margin-left:1.25in;
	text-indent:-9.0pt;}
@list l7
	{mso-list-id:1755972505;
	mso-list-type:hybrid;
	mso-list-template-ids:1148484412 67698703 67698713 67698715 67698703 67698=
713 67698715 67698703 67698713 67698715;}
@list l7:level1
	{mso-level-tab-stop:.75in;
	mso-level-number-position:left;
	margin-left:.75in;
	text-indent:-.25in;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
</head>

<body lang=3DEN-US style=3D'tab-interval:.5in'>

<div class=3DSection1>

<h1 align=3Dcenter style=3D'text-align:center'><span style=3D'font-family:"=
Times New Roman";
mso-font-kerning:0pt;mso-bidi-font-weight:normal'>MIDDLE LAYER QUICK REFERE=
NCE<o:p></o:p></span></h1>

<p class=3DMsoNormal align=3Dcenter style=3D'text-align:center'>Gregory J. =
Portmann</p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal>This is meant to be a quick reference guide.<span
style=3D'mso-spacerun:yes'>&nbsp; </span>It is not a complete explanation o=
f the
details of each function.<span style=3D'mso-spacerun:yes'>&nbsp; </span>Mos=
t of
the flexibility of each function is not discussed.<span
style=3D'mso-spacerun:yes'>&nbsp; </span>It is designed so that one can cut=
/paste
from this document directly into the Matlab command window to do common tas=
ks
quickly.<span style=3D'mso-spacerun:yes'>&nbsp; </span>Most of these comman=
ds
(and more) are accessible from <i style=3D'mso-bidi-font-style:normal'>plot=
family</i>.</p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;text-indent:-27.0pt;mso-li=
st:l6 level1 lfo1;
tab-stops:list 27.0pt'><![if !supportLists]><b style=3D'mso-bidi-font-weigh=
t:
normal'><span style=3D'font-size:14.0pt'><span style=3D'mso-list:Ignore'>1.=
<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><![endif]><st1:place w:st=3D"on"><st1:PlaceName w:=
st=3D"on"><b
  style=3D'mso-bidi-font-weight:normal'><span style=3D'font-size:14.0pt'>Ma=
chine</span></b></st1:PlaceName><b
 style=3D'mso-bidi-font-weight:normal'><span style=3D'font-size:14.0pt'> <s=
t1:PlaceType
 w:st=3D"on">State</st1:PlaceType></span></b></st1:place><b style=3D'mso-bi=
di-font-weight:
normal'><span style=3D'font-size:14.0pt'><o:p></o:p></span></b></p>

<p class=3DMsoNormal style=3D'margin-left:.75in;text-indent:-27.0pt;mso-lis=
t:l6 level2 lfo1;
tab-stops:list 45.0pt'><![if !supportLists]><span style=3D'mso-list:Ignore'=
>a.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
 </span></span><![endif]>Units:
Hardware or Physics<span style=3D'mso-spacerun:yes'>&nbsp; </span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>switch2hw<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>switch2physics<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'>Each family can be put in=
 either
hardware or physics units but it is not recommended to do this.<span
style=3D'mso-spacerun:yes'>&nbsp; </span>Spear3 will operate in hardware un=
its
for all applications.<span style=3D'mso-spacerun:yes'>&nbsp; </span>One can
override the units on the input to many functions.</p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt;text-indent:-.25in;mso-lis=
t:l6 level2 lfo1;
tab-stops:list 45.0pt'><![if !supportLists]><span style=3D'mso-list:Ignore'=
>b.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </spa=
n></span><![endif]>Mode:
Online or Simulate<span style=3D'mso-spacerun:yes'>&nbsp; </span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>switch2online<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>switch2sim<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'>Each family can be put in=
 either
online or simulate mode but it is not recommended to do this.<span
style=3D'mso-spacerun:yes'>&nbsp; </span>The default mode for Spear3 is
online.<span style=3D'mso-spacerun:yes'>&nbsp; </span>One can override the =
mode on
the input to many functions.</p>

<p class=3DMsoNormal style=3D'margin-left:.75in'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;text-indent:-27.0pt;mso-li=
st:l6 level1 lfo1;
tab-stops:list 27.0pt'><![if !supportLists]><b style=3D'mso-bidi-font-weigh=
t:
normal'><span style=3D'font-size:14.0pt'><span style=3D'mso-list:Ignore'>2.=
<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><![endif]><b style=3D'mso-bidi-font-weight:normal'=
><span
style=3D'font-size:14.0pt'>Common flags<o:p></o:p></span></b></p>

<p class=3DMsoNormal style=3D'margin-left:.75in;text-indent:-27.0pt;mso-lis=
t:l6 level2 lfo1;
tab-stops:list 45.0pt'><![if !supportLists]><span style=3D'mso-list:Ignore'=
>a.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
 </span></span><![endif]><span
style=3D'font-family:Arial'>&#8217;Hardware&#8217; or &#8217;Physics&#8217;=
</span></p>

<p class=3DMsoNormal style=3D'margin-left:.75in;text-indent:-27.0pt;mso-lis=
t:l6 level2 lfo1;
tab-stops:list 45.0pt'><![if !supportLists]><span style=3D'mso-list:Ignore'=
>b.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </spa=
n></span><![endif]><span
style=3D'font-family:Arial'>&#8217;Online&#8217;, &#8217;Simulator&#8217;,
&#8217;Model&#8217;, or &#8217;Manual&#8217;</span></p>

<p class=3DMsoNormal style=3D'margin-left:.75in;text-indent:-27.0pt;mso-lis=
t:l6 level2 lfo1;
tab-stops:list 45.0pt'><![if !supportLists]><span style=3D'mso-list:Ignore'=
>c.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
 </span></span><![endif]><span
style=3D'font-family:Arial'>&#8217;Struct&#8217; or &#8217;Numeric&#8217;</=
span></p>

<p class=3DMsoNormal style=3D'margin-left:.75in;text-indent:-27.0pt;mso-lis=
t:l6 level2 lfo1;
tab-stops:list 45.0pt'><![if !supportLists]><span style=3D'mso-list:Ignore'=
>d.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </spa=
n></span><![endif]><span
style=3D'font-family:Arial'>&#8217;Archive&#8217; or &#8217;NoArchive&#8217=
;</span></p>

<p class=3DMsoNormal style=3D'margin-left:.75in;text-indent:-27.0pt;mso-lis=
t:l6 level2 lfo1;
tab-stops:list 45.0pt'><![if !supportLists]><span style=3D'mso-list:Ignore'=
>e.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
 </span></span><![endif]><span
style=3D'font-family:Arial'>&#8217;Display&#8217; or &#8217;NoDisplay&#8217=
;</span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>Flag are not case sensiti=
ve
(familynames are case sensitive).<span style=3D'mso-spacerun:yes'>&nbsp;
</span>Note:<span style=3D'mso-spacerun:yes'>&nbsp; </span>in the future Ma=
tlab
on the PC will be case sensitive on filename, just like Unix.</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;text-indent:-27.0pt;mso-li=
st:l6 level1 lfo1;
tab-stops:list 27.0pt'><![if !supportLists]><b style=3D'mso-bidi-font-weigh=
t:
normal'><span style=3D'font-size:14.0pt'><span style=3D'mso-list:Ignore'>3.=
<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><![endif]><b style=3D'mso-bidi-font-weight:normal'=
><span
style=3D'font-size:14.0pt'>Get/Save Orbits<o:p></o:p></span></b></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt;text-indent:-.25in;mso-lis=
t:l6 level2 lfo1;
tab-stops:list 45.0pt'><![if !supportLists]><span style=3D'mso-list:Ignore'=
>a.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
 </span></span><![endif]>Get
an orbit</p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>x
=3D getx;<span style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;
</span>% or<span style=3D'mso-spacerun:yes'>&nbsp; </span>x =3D getam('BPMx=
');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>y
=3D gety;<span style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;
</span>% or<span style=3D'mso-spacerun:yes'>&nbsp; </span>y =3D getam('BPMy=
');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>Note
1:<span style=3D'mso-spacerun:yes'>&nbsp; </span>Use an optional 'Struct' i=
nput
to return a data structure<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>Note
2:<span style=3D'mso-spacerun:yes'>&nbsp; </span>To graphically view orbits=
 use
plotorbit or plotfamily.<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:.75in'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt;text-indent:-.25in;mso-lis=
t:l6 level2 lfo1;
tab-stops:list 45.0pt'><![if !supportLists]><span style=3D'mso-list:Ignore'=
>b.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </spa=
n></span><![endif]>Save
orbit data to the default directory for orbits</p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>getbpm('Archive');<span
style=3D'mso-tab-count:1'>&nbsp; </span><span style=3D'mso-spacerun:yes'>&n=
bsp;
</span><o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>getbpm('Archive',
FileName);<span style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp; </span><span
style=3D'mso-spacerun:yes'>&nbsp; </span>% to save data to FileName<o:p></o=
:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:.75in'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt;text-indent:-.25in;mso-lis=
t:l6 level2 lfo1;
tab-stops:list 45.0pt'><![if !supportLists]><span style=3D'mso-list:Ignore'=
>c.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
 </span></span><![endif]>Get
the default Golden and Offset orbits</p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>Xgolden
=3D getgolden('BPMx');<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </spa=
n>%
Horizontal golden orbit<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>Ygolden
=3D getgolden('BPMy');<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </spa=
n>%
Vertical golden orbit<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>Xoffset
=3D getoffset('BPMx');<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;
</span>% Horizontal offset orbit<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>Yoffset
=3D getoffset('BPMy');<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;
</span>% Vertical offset orbit<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:.5in'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt;text-indent:-.25in;mso-lis=
t:l6 level2 lfo1;
tab-stops:list 45.0pt'><![if !supportLists]><span style=3D'mso-list:Ignore'=
>d.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </spa=
n></span><![endif]>Save
the present orbit as the default golden orbit</p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'>How this is done depends =
on the
accelerators.<span style=3D'mso-spacerun:yes'>&nbsp; </span>Ultimately the =
AO.BPMx.Golden
field needs to be set properly.<span style=3D'mso-spacerun:yes'>&nbsp; </sp=
an>At
Spear, the golden orbit is saved in the spear3physdata file and loaded into=
 the
AO by spear3init.<span style=3D'mso-spacerun:yes'>&nbsp; </span>Hence, at S=
pear
to change to a new golden orbit run the following code then run spear3init.=
.</p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>setphysdata('BPMx',
'Golden', BPMxGolden, DeviceList);<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>setphysdata('BPMy',
'Golden', BPMyGolden, DeviceList);<o:p></o:p></span></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'>At <st1:State w:st=3D"on"=
>AL</st1:State>S,
the golden and offset orbits are changed by directly editing the
setoperationalmode file.<span style=3D'mso-spacerun:yes'>&nbsp; </span>CLS =
make
the appropriate changes to the AO in clsinit.</p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'>Keeping track of past gol=
den and
offset orbits can be cumbersome.<span style=3D'mso-spacerun:yes'>&nbsp; </s=
pan>I
usually save them by date on the day the new orbit is made.<span
style=3D'mso-spacerun:yes'>&nbsp; </span>The functions savegoldenorbit and
saveoffsetorbit are a simple way to do it.</p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt;text-indent:-.25in;mso-lis=
t:l6 level2 lfo1;
tab-stops:list 45.0pt'><![if !supportLists]><span style=3D'mso-list:Ignore'=
>e.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
 </span></span><![endif]>Find
and save BPM data (used for standard deviations, etc)</p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>monbpm;<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>%
To make this file the default BPM sigma file<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>copybpmsigmafile;<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp; </span><o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:.75in'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt;text-indent:-.25in;mso-lis=
t:l6 level2 lfo1;
tab-stops:list 45.0pt'><![if !supportLists]><span style=3D'mso-list:Ignore'=
>f.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;
</span></span><![endif]>Converting between raw control system data and
calibrated data</p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>RealData
=3D raw2real(Family, RawData, DeviceList)<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>RawData
=3D real2raw(Family, RealData, DeviceList)<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>To
get the actual calibration numbers:<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>Gain
=3D getgain('BPMx');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>Offset
=3D getoffset('BPMx');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:.75in'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;text-indent:-27.0pt;mso-li=
st:l6 level1 lfo1;
tab-stops:list 27.0pt'><![if !supportLists]><b style=3D'mso-bidi-font-weigh=
t:
normal'><span style=3D'font-size:14.0pt'><span style=3D'mso-list:Ignore'>4.=
<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><![endif]><b style=3D'mso-bidi-font-weight:normal'=
><span
style=3D'font-size:14.0pt'>Get/Set magnet settings<o:p></o:p></span></b></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt;text-indent:-.25in;mso-lis=
t:l6 level2 lfo1;
tab-stops:list 45.0pt'><![if !supportLists]><span style=3D'mso-list:Ignore'=
>a.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
 </span></span><![endif]>Get
all the horizontal corrector setpoint and monitor values</p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>SP
=3D getsp('HCM');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>AM
=3D getam('HCM');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:.75in'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt;text-indent:-.25in;mso-lis=
t:l6 level2 lfo1;
tab-stops:list 45.0pt'><![if !supportLists]><span style=3D'mso-list:Ignore'=
>b.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </spa=
n></span><![endif]>Set
HCM(2,1)=3D1 and HCM(2,4)=3D12</p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>setsp('HCM',
[1;12], [2 1; 2 4]);<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:.75in'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt;text-indent:-.25in;mso-lis=
t:l6 level2 lfo1;
tab-stops:list 45.0pt'><![if !supportLists]><span style=3D'mso-list:Ignore'=
>c.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
 </span></span><![endif]>Set
all horizontal corrector to zero</p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><span style=3D'font-famil=
y:Arial'>setsp('HCM',
0);<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>Note 1:<span
style=3D'mso-spacerun:yes'>&nbsp; </span><i style=3D'mso-bidi-font-style:no=
rmal'>getfamilylist</i>
returns the names of all families.</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>Note 2:<span
style=3D'mso-spacerun:yes'>&nbsp; </span>To graphically view magnets setpoi=
nts
and monitors use <i style=3D'mso-bidi-font-style:normal'>plotfamily</i>.</p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;text-indent:-27.0pt;mso-li=
st:l6 level1 lfo1;
tab-stops:list 27.0pt'><![if !supportLists]><b style=3D'mso-bidi-font-weigh=
t:
normal'><span style=3D'font-size:14.0pt'><span style=3D'mso-list:Ignore'>5.=
<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><![endif]><b style=3D'mso-bidi-font-weight:normal'=
><span
style=3D'font-size:14.0pt'>Global orbit correction<o:p></o:p></span></b></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><b style=3D'mso-bidi-font=
-weight:
normal'><i style=3D'mso-bidi-font-style:normal'>(to be written, but use set=
orbit </i>or<i
style=3D'mso-bidi-font-style:normal'> setorbitdefault)<o:p></o:p></i></b></=
p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;text-indent:-27.0pt;mso-li=
st:l6 level1 lfo1;
tab-stops:list 27.0pt'><![if !supportLists]><b><span style=3D'font-size:14.=
0pt;
mso-bidi-font-size:12.0pt'><span style=3D'mso-list:Ignore'>6.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><![endif]><b><span style=3D'font-size:14.0pt;mso-b=
idi-font-size:
12.0pt'>Local orbit correction<o:p></o:p></span></b></p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><b style=3D'mso-bidi-font=
-weight:
normal'><i style=3D'mso-bidi-font-style:normal'>(to be written, but use
setorbitbump)<o:p></o:p></i></b></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;text-indent:-27.0pt;mso-li=
st:l6 level1 lfo1;
tab-stops:list 27.0pt'><![if !supportLists]><b style=3D'mso-bidi-font-weigh=
t:
normal'><span style=3D'font-size:14.0pt'><span style=3D'mso-list:Ignore'>7.=
<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><![endif]><b style=3D'mso-bidi-font-weight:normal'=
><span
style=3D'font-size:14.0pt'>Retrieve <span
style=3D'mso-spacerun:yes'>&nbsp;</span>an orbit response matrix<o:p></o:p>=
</span></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Default response matrix<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>R
=3D getbpmresp;<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Retreive response matrix from file<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>R
=3D getbpmresp(Filename);<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>R
=3D getbpmresp('');<span style=3D'mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
 </span>%
For a browser<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Model response matrix<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>R
=3D measbpmresp('Model');<o:p></o:p></span></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;text-indent:-27.0pt;mso-li=
st:l6 level1 lfo1;
tab-stops:list 27.0pt'><![if !supportLists]><b style=3D'mso-bidi-font-weigh=
t:
normal'><span style=3D'font-size:14.0pt'><span style=3D'mso-list:Ignore'>8.=
<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><![endif]><b style=3D'mso-bidi-font-weight:normal'=
><span
style=3D'font-size:14.0pt'>Measure an orbit response matrix (and set as the
default)<o:p></o:p></span></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><i style=3D'mso-bidi-font=
-style:
normal'>measbpmresp</i> measures the orbit response matrix.<span
style=3D'mso-spacerun:yes'>&nbsp; </span>The units for the orbit response m=
atrix
at Spear is always [mm/amp] (hardware units). <span
style=3D'mso-spacerun:yes'>&nbsp;</span>See <i style=3D'mso-bidi-font-style=
:normal'>help</i>
<i style=3D'mso-bidi-font-style:normal'>measbpmresp</i> for more details.<s=
pan
style=3D'mso-spacerun:yes'>&nbsp; </span></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Defaults for online response matrices<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>R
=3D measbpmresp;<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>is the same as,<o:p></=
o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:135.0pt;text-indent:-1.5in'><span
style=3D'font-family:Arial'>R =3D measbpmresp('BPMx', 'BPMy', 'HCM', 'VCM',
'Online', 'Bipolar', 'Numeric', 'Archive');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Defaults for model response matrices<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>R
=3D measbpmresp('Model');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>is the same as,<o:p></=
o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:135.0pt;text-indent:-1.5in'><span
style=3D'font-family:Arial'>R =3D measbpmresp('BPMx', 'BPMy', 'HCM', 'VCM',
'Model', Bipolar', 'Numeric', 'NoArchive', 'FixedPathLength', 'Full');<o:p>=
</o:p></span></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Get a response matrix for 3 BPMs and 2 Correctors w/o saving data.<o:p></o:=
p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
(the data is saved to disk by default if 'Online', use the 'NoArchive' <o:p=
></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
flag suppress this).<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-top:0in;margin-right:-.75in;margin-bot=
tom:
0in;margin-left:27.0pt;margin-bottom:.0001pt'><span style=3D'font-family:Ar=
ial'>R1
=3D measbpmresp('BPMx', [1 1;2 2;6 3], 'BPMy', [1 1;2 2;6 3], 'HCM', [1 1; =
1 3],
'VCM', [1 1; 1 2], 'NoArchive');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-top:0in;margin-right:-.75in;margin-bot=
tom:
0in;margin-left:27.0pt;margin-bottom:.0001pt'><span style=3D'font-family:Ar=
ial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Get a the same data from the model<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
The default for the model is not to save data to disk.<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-top:0in;margin-right:-.75in;margin-bot=
tom:
0in;margin-left:27.0pt;margin-bottom:.0001pt'><span style=3D'font-family:Ar=
ial'>R2
=3D measbpmresp('BPMx', [1 1;2 2;6 3], 'BPMy', [1 1;2 2;6 3], 'HCM', [1 1; =
1 3],
'VCM', [1 1; 1 2], 'Model');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Compare a column (ie, a corrector magnet response) <o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>plot(R2(:,1)
- R1(:,1));<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Get a the same data from the model w/ a FixedMomentum, Linear model<o:p></o=
:p></span></p>

<p class=3DMsoNormal style=3D'margin-top:0in;margin-right:-.75in;margin-bot=
tom:
0in;margin-left:135.0pt;margin-bottom:.0001pt;text-indent:-1.5in'><span
style=3D'font-family:Arial'>R2 =3D measbpmresp('BPMx', 'BPMy', 'HCM', [1 1;=
 1 3],
'VCM', [1 1; 1 2], 'FixedMomentum', 'Linear', 'Model');<o:p></o:p></span></=
p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>The default filename and
directory is,</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span
style=3D'mso-spacerun:yes'>&nbsp;</span>&lt;DataRoot&gt;\Response\BPM\&lt;
BPMRespFile&gt;&lt;Date&gt;&lt;Time&gt;.mat</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>To make this file the def=
ault
operational file, copy it to:</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span
style=3D'mso-spacerun:yes'>&nbsp;</span>&lt;OpsData&gt;\&lt; BPMRespFile&gt=
;.mat</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>It is best to use the fol=
lowing
function to do the copy (in plotfamily).</p>

<p class=3DMsoNormal style=3D'text-indent:27.0pt'><span style=3D'font-famil=
y:Arial'>copybpmrespfile;<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp; </span><o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;text-indent:-27.0pt;mso-li=
st:l6 level1 lfo1;
tab-stops:list 27.0pt'><![if !supportLists]><b style=3D'mso-bidi-font-weigh=
t:
normal'><span style=3D'font-size:14.0pt'><span style=3D'mso-list:Ignore'>9.=
<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span></b><![endif]><b style=3D'mso-bidi-font-weight:normal'=
><span
style=3D'font-size:14.0pt'>Get/Set/Step RF frequency<o:p></o:p></span></b><=
/p>

<p class=3DMsoNormal style=3D'margin-left:45.0pt'><b style=3D'mso-bidi-font=
-weight:
normal'><i style=3D'mso-bidi-font-style:normal'>(see help getrf, setrf, ste=
prf in
Matlab)<o:p></o:p></i></b></p>

<p class=3DMsoNormal><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-size:14.0pt'><o:p>&nbsp;</o:p></span></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;text-indent:-27.0pt;mso-li=
st:l6 level1 lfo1;
tab-stops:list 27.0pt'><![if !supportLists]><b style=3D'mso-bidi-font-weigh=
t:
normal'><span style=3D'font-size:14.0pt'><span style=3D'mso-list:Ignore'>10=
.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </spa=
n></span></span></b><![endif]><b
style=3D'mso-bidi-font-weight:normal'><span style=3D'font-size:14.0pt'>Get/=
Save/Plot
Dispersion<o:p></o:p></span></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>The dispersion is measure=
d with
the <i style=3D'mso-bidi-font-style:normal'>measdisp</i> function.<span
style=3D'mso-spacerun:yes'>&nbsp; </span>The orbit shift verses RF or momen=
tum
will be plotted.<span style=3D'mso-spacerun:yes'>&nbsp; </span>The default =
units
for dispersion are change in orbit per change in RF frequency [mm/MHz]
(hardware units at Spear).<span style=3D'mso-spacerun:yes'>&nbsp; </span>Ho=
wever,
one can select units of change in orbit per change in momentum [meters/(dp/=
p)]
(physics units) by adding 'Physics' to the input line.<span
style=3D'mso-spacerun:yes'>&nbsp; </span>A structure output is selected by =
adding
'Struct' to the input line.<span style=3D'mso-spacerun:yes'>&nbsp; </span>T=
he
fields of the structure are similar to a response matrix structure (delta o=
rbit
for a delta change in RF frequency).<span style=3D'mso-spacerun:yes'>&nbsp;
</span>Use <i style=3D'mso-bidi-font-style:normal'>plotdisp</i> to plot a p=
ast
measurement.<span style=3D'mso-spacerun:yes'>&nbsp; </span>See help <i
style=3D'mso-bidi-font-style:normal'>measdisp</i> for more details.</p>

<p class=3DMsoNormal style=3D'margin-left:.75in'><span style=3D'font-family=
:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Measure the dispersion (vector output)<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>[Dx,
Dy] =3D measdisp;<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Measure the dispersion (structure output)<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>[Dx,
Dy] =3D measdisp('Struct');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Measure the dispersion in physics units </span>[1/(dp/p)]<span
style=3D'font-family:Arial'><o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>[Dx,
Dy] =3D measdisp ('Struct', 'Physics');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Measure the dispersion and archive (output is optional)<o:p></o:p></span></=
p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>measdisp
('Archive');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Measure and plot the dispersion<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
No outputs or 'Display' on the input line will automatically plot<o:p></o:p=
></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>[Dx,
Dy] =3D measdisp('Display');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>measdisp;<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><span
style=3D'mso-spacerun:yes'>&nbsp;</span><o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Plot using plotdisp function<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><span
style=3D'mso-spacerun:yes'>&nbsp;</span>[Dx, Dy] =3D measdisp('Struct');<o:=
p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>plotdisp(Dx,
Dy);<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>plotdisp('');<span
style=3D'mso-tab-count:4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%
Plot data from a file<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Model dispersion (override the Mode to Simulate)<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>[Dx,
Dy] =3D measdisp('Simulator');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Model dispersion (calls AT directly)<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>[Dx,
Dy] =3D measdisp('Model');<span style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%
calls modeldisp<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:.75in'><span style=3D'font-family=
:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:.5in'><span style=3D'font-family:=
Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;text-indent:-27.0pt;mso-li=
st:l6 level1 lfo1;
tab-stops:list 27.0pt'><![if !supportLists]><b><span style=3D'font-size:14.=
0pt;
mso-bidi-font-size:12.0pt'><span style=3D'mso-list:Ignore'>11.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </spa=
n></span></span></b><![endif]><b><span
style=3D'font-size:14.0pt;mso-bidi-font-size:12.0pt'>Tune<o:p></o:p></span>=
</b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><b><span style=3D'font-si=
ze:14.0pt;
mso-bidi-font-size:12.0pt'><o:p>&nbsp;</o:p></span></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><b>Get/Set/Step tunes<o:p=
></o:p></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Measure the tune and return a 2x1 vector<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>Tune
=3D gettune;<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Measure the tune and return a structure<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>Tune
=3D gettune('Struct');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><b><span style=3D'font-si=
ze:14.0pt;
mso-bidi-font-size:12.0pt'><o:p>&nbsp;</o:p></span></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><b>Measure a tune respons=
e matrix
(and set as the default) <o:p></o:p></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><i style=3D'mso-bidi-font=
-style:
normal'>meastuneresp</i> measures the tune response matrix.<span
style=3D'mso-spacerun:yes'>&nbsp; </span>The units for the tune response ma=
trix
at Spear is [Fractional Tune/Amp] (hardware units).<span
style=3D'mso-spacerun:yes'>&nbsp; </span>See help <i style=3D'mso-bidi-font=
-style:
normal'>meastuneresp</i> for more details.</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>The default filename and
directory is,</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span
style=3D'mso-spacerun:yes'>&nbsp;</span>&lt;DataRoot&gt;\Response\Tune\&lt;
TuneRespFile&gt;&lt;Date&gt;&lt;Time&gt;.mat</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>To make this file the def=
ault
operational file, copy it to:</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span
style=3D'mso-spacerun:yes'>&nbsp;</span>&lt;OpsData&gt;\&lt; TuneRespFile&g=
t;.mat</p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>It is best to use the fol=
lowing
function to do the copy (in plotfamily). </p>

<p class=3DMsoNormal style=3D'text-indent:27.0pt'><span style=3D'font-famil=
y:Arial'>copytunerespfile;<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp; </span><o:p></o:p></span></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><b>Step the tune and get =
the tune
response matrix<o:p></o:p></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>To change the tune by [-.=
05;
.05], simple use the <i style=3D'mso-bidi-font-style:normal'>steptune</i>
command.</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>steptune([-.05;
.05]);<o:p></o:p></span></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>The <i style=3D'mso-bidi-=
font-style:
normal'>steptune</i> function can easily be done manually:</p>

<p class=3DMsoNormal style=3D'margin-left:.5in'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>% Measure the tune (just =
to check
the result)</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>Tune1
=3D gettune;<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>% Get the chromaticity re=
sponse
matrix for SF and SD</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;tab-stops:2.5in'><span
style=3D'font-family:Arial'>m =3D gettuneresp; <span style=3D'mso-tab-count=
:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%
Default (used by settune, steptune)<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;tab-stops:2.5in'><span
style=3D'font-family:Arial'>m =3D gettuneresp('Model');<span style=3D'mso-t=
ab-count:
1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>% Model<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>% Compute the delta QF an=
d QD and
apply the correction</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>DeltaAmps
=3D inv(m) * [-.05; .05];<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-top:0in;margin-right:-27.0pt;margin-bo=
ttom:
0in;margin-left:27.0pt;margin-bottom:.0001pt'><span style=3D'font-family:Ar=
ial'>setsp({'QF',
'QD'}, {getsp('QF')+DeltaAmps(1), getsp('QD')+DeltaAmps(2)});<o:p></o:p></s=
pan></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>% Measure the chromaticit=
y and
check result</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>Tune2
=3D gettune;<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>DeltaTune
=3D Tune2 - Tune1<o:p></o:p></span></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;text-indent:-27.0pt;mso-li=
st:l6 level1 lfo1;
tab-stops:list 27.0pt'><![if !supportLists]><b style=3D'mso-bidi-font-weigh=
t:
normal'><span style=3D'font-size:14.0pt'><span style=3D'mso-list:Ignore'>12=
.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </spa=
n></span></span></b><![endif]><b
style=3D'mso-bidi-font-weight:normal'><span style=3D'font-size:14.0pt'>Chro=
maticity<o:p></o:p></span></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><b><span style=3D'font-si=
ze:14.0pt;
mso-bidi-font-size:12.0pt'><o:p>&nbsp;</o:p></span></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><b>Measure a chromaticity=
<o:p></o:p></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>Measure the chromaticity =
using
the <i style=3D'mso-bidi-font-style:normal'>measchro</i> command.<span
style=3D'mso-spacerun:yes'>&nbsp; </span>The tune shift verses RF or moment=
um
will be plotted.<span style=3D'mso-spacerun:yes'>&nbsp; </span>Chromaticity=
 being
the linear term in the curve fit.<span style=3D'mso-spacerun:yes'>&nbsp;
</span>Verify that the curve fit looks &#8220;accurate.&#8221;<span
style=3D'mso-spacerun:yes'>&nbsp; </span>Note: when the chromaticity is clo=
se to
zero small tune errors can produce an inaccurate chromaticity measurement.<=
span
style=3D'mso-spacerun:yes'>&nbsp; </span>The default units for chromaticity=
 are
change in tune per change in RF frequency [1/MHz] (hardware units).<span
style=3D'mso-spacerun:yes'>&nbsp; </span>However, one can select units of c=
hange
in tune per change in momentum [1/(dp/p)] (physics units) by adding <span
style=3D'font-family:Arial'>'Physics'</span> to the input line.<span
style=3D'mso-spacerun:yes'>&nbsp; </span>The default output is the 2x1
chromaticity vector, however, a structure output is selected by adding <span
style=3D'font-family:Arial'>'Struct'</span> to the input line.<span
style=3D'mso-spacerun:yes'>&nbsp; </span>The fields of the structure are si=
milar
to a response matrix structure.<span style=3D'mso-spacerun:yes'>&nbsp; </sp=
an><i
style=3D'mso-bidi-font-style:normal'>measchro</i> automatically plots the r=
esults<span
style=3D'mso-spacerun:yes'>&nbsp; </span>Use <i style=3D'mso-bidi-font-styl=
e:normal'>plotchro</i>
to plot a past measurement.<span style=3D'mso-spacerun:yes'>&nbsp; </span>S=
ee
help <i style=3D'mso-bidi-font-style:normal'>measchro</i> for more details.=
</p>

<p class=3DMsoNormal><b><span style=3D'font-size:14.0pt;mso-bidi-font-size:=
12.0pt'><o:p>&nbsp;</o:p></span></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Measure the chromaticity and return a 2x1 vector (units [1/MHz])<o:p></o:p>=
</span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>Chro
=3D measchro;<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Measure the chromaticity and return a structure<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>ChroStruct
=3D measchro('Struct');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Measure the chromaticity is physics units </span>[1/(dp/p)]<span
style=3D'font-family:Arial'><o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>ChroStruct
=3D measchro('Struct', 'Physics');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Measure the chromaticity and archive to the appropriate directory<o:p></o:p=
></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>measchro('Archive');
<span style=3D'mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%
Output is optional<o:p></o:p></span></p>

<p class=3DMsoNormal><b><span style=3D'font-size:14.0pt;mso-bidi-font-size:=
12.0pt'><o:p>&nbsp;</o:p></span></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Plot the chromaticity measurement<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>C
=3D measchro('Struct');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>plotchro(C);<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>plotchro('');<span
style=3D'mso-tab-count:4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%
Plot data from a file<o:p></o:p></span></p>

<p class=3DMsoNormal><b><span style=3D'font-size:14.0pt;mso-bidi-font-size:=
12.0pt'><o:p>&nbsp;</o:p></span></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><b>Measure a chromaticity
response matrix (and set as the default)<o:p></o:p></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><i style=3D'mso-bidi-font=
-style:
normal'>measchroresp</i> measures the chromacity response matrix for the
default sextupole families.<span style=3D'mso-spacerun:yes'>&nbsp; </span>T=
he
units for the chromacity response matrix at Spear is [1/MHz] (hardware
units).<span style=3D'mso-spacerun:yes'>&nbsp; </span>See help <i
style=3D'mso-bidi-font-style:normal'>measchroresp</i> for more details.</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>The default filename and
directory is,</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span
style=3D'mso-spacerun:yes'>&nbsp;</span>&lt;DataRoot&gt;\Response\Chromatic=
ity\&lt;
GoldenChroResp&gt;&lt;Date&gt;&lt;Time&gt;.mat</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>To make this file the def=
ault
operational file, copy it to:</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span
style=3D'mso-spacerun:yes'>&nbsp;</span>&lt;OpsData&gt;\&lt; GoldenChroResp=
&gt;.mat</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>It is best to use the fol=
lowing
function to do the copy (in plotfamily).</p>

<p class=3DMsoNormal style=3D'text-indent:27.0pt'><span style=3D'font-famil=
y:Arial'>copychrorespfile;<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp; </span><o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><b>Step the chromaticity =
and get
the chromaticity response matrix<o:p></o:p></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>To change the chromaticit=
y by
[-.25; .25] [1/MHz], simple use the <i style=3D'mso-bidi-font-style:normal'=
>stepchro</i>
command.</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>stepchro([-.25;
.25]);<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>If the chromaticity was m=
easured
in physics units and the response matrix was measured in hardware units then
convert it before passing it to <i style=3D'mso-bidi-font-style:normal'>ste=
pchro</i>.<span
style=3D'mso-spacerun:yes'>&nbsp; </span>For RF=3D476.3 and MCF=3D.0011,</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>stepchro([.1346;
-.1346] / -RF / MCF);<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>However, it is best to st=
ick with
one set of units for all measurements.</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>The <i style=3D'mso-bidi-=
font-style:
normal'>stepchro</i> function can easily be done manually:</p>

<p class=3DMsoNormal style=3D'margin-left:.5in'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>% Measure the chromaticit=
y (just
to check the result)</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>figure(1);</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>Chro1
=3D measchro;<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>% Get the chromaticity re=
sponse
matrix for SF and SD</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;tab-stops:2.5in'><span
style=3D'font-family:Arial'>m =3D getchroresp; <span style=3D'mso-tab-count=
:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%
Default (use by stepchro)<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;tab-stops:2.5in'><span
style=3D'font-family:Arial'>m =3D getchroresp('Model');<span style=3D'mso-t=
ab-count:
1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>% Model<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>% Compute the delta SF an=
d SD and
apply the correction</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>DeltaAmps
=3D inv(m) * [-.25; .25];<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-top:0in;margin-right:-27.0pt;margin-bo=
ttom:
0in;margin-left:27.0pt;margin-bottom:.0001pt'><span style=3D'font-family:Ar=
ial'>setsp({'SF',
'SD'}, {getsp('SF')+DeltaAmps(1), getsp('SD')+DeltaAmps(2)});<o:p></o:p></s=
pan></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>% Measure the chromaticit=
y and
check result</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>figure(2);</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>Chro2
=3D measchro;<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>DeltaCrho
=3D Chro2 - Chro1<o:p></o:p></span></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;text-indent:-27.0pt;mso-li=
st:l6 level1 lfo1;
tab-stops:list 27.0pt'><![if !supportLists]><b style=3D'mso-bidi-font-weigh=
t:
normal'><span style=3D'font-size:14.0pt'><span style=3D'mso-list:Ignore'>13=
.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </spa=
n></span></span></b><![endif]><b
style=3D'mso-bidi-font-weight:normal'><span style=3D'font-size:14.0pt'>Save=
/restore<o:p></o:p></span></b></p>

<ul style=3D'margin-top:0in' type=3Ddisc>
 <li class=3DMsoNormal style=3D'mso-list:l1 level1 lfo3;tab-stops:list .5in=
'>Archive
     a lattice</li>
 <li class=3DMsoNormal style=3D'mso-list:l1 level1 lfo3;tab-stops:list .5in=
'>Make
     the default magnet lattice for operations</li>
</ul>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>The default filename and
directory for archiving is,</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span
style=3D'mso-spacerun:yes'>&nbsp;</span>&lt;DataRoot&gt;\&lt; ConfigData&gt=
;\ &lt;LatticeFile&gt;&lt;Date&gt;&lt;Time&gt;.mat</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>To make this file the def=
ault
operational file, copy it to:</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span
style=3D'mso-spacerun:yes'>&nbsp;</span>&lt;OpsData&gt;\&lt; LatticeFile&gt=
;.mat</p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>It is best to use the fol=
lowing
function to do the copy (in plotfamily). </p>

<p class=3DMsoNormal style=3D'text-indent:27.0pt'><span style=3D'font-famil=
y:Arial'>copymachineconfigfile;<o:p></o:p></span></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;text-indent:-27.0pt;mso-li=
st:l6 level1 lfo1;
tab-stops:list 27.0pt'><![if !supportLists]><b style=3D'mso-bidi-font-weigh=
t:
normal'><span style=3D'font-size:14.0pt'><span style=3D'mso-list:Ignore'>14=
.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </spa=
n></span></span></b><![endif]><b
style=3D'mso-bidi-font-weight:normal'><span style=3D'font-size:14.0pt'>Prep=
are a
LOCO input file<o:p></o:p></span></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>LOCO requires an orbit re=
sponse
matrix, dispersion, and the standard deviations of the BPM difference
orbits.<span style=3D'mso-spacerun:yes'>&nbsp; </span>Measure a new orbit
response matrix with <i style=3D'mso-bidi-font-style:normal'>measbpmresp</i=
>,
dispersion with <i style=3D'mso-bidi-font-style:normal'>measdisp('Archive')=
,</i>
and new BPM standard deviations <i style=3D'mso-bidi-font-style:normal'>mon=
bpm</i>.<span
style=3D'mso-spacerun:yes'>&nbsp; </span>Or use <i style=3D'mso-bidi-font-s=
tyle:
normal'>measlocodata</i> to do it all at once.<span
style=3D'mso-spacerun:yes'>&nbsp; </span>Combine the output from these func=
tions
with <i style=3D'mso-bidi-font-style:normal'>buildlocoinput</i>.<span
style=3D'mso-spacerun:yes'>&nbsp; </span>The accelerator specific part of t=
he function
in broken out as <i style=3D'mso-bidi-font-style:normal'>buildlocofitparame=
ters</i>.<b
style=3D'mso-bidi-font-weight:normal'><i style=3D'mso-bidi-font-style:norma=
l'><o:p></o:p></i></b></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;text-indent:-27.0pt;mso-li=
st:l6 level1 lfo1;
tab-stops:list 27.0pt'><![if !supportLists]><b style=3D'mso-bidi-font-weigh=
t:
normal'><span style=3D'font-size:14.0pt'><span style=3D'mso-list:Ignore'>15=
.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </spa=
n></span></span></b><![endif]><b
style=3D'mso-bidi-font-weight:normal'><span style=3D'font-size:14.0pt'>Find=
ing
quadrupole centers<o:p></o:p></span></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>To find the offset betwee=
n the
orbit at the BPM and quadrupole:</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
One quadrupole center<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>quadcenter;<span
style=3D'mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%
Data is automatically saved to a subdirectory<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:135.0pt;text-indent:9.0pt'><span
style=3D'font-family:Arial'>% of DataRoot&gt;\QMS named by date and time<o:=
p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Find all quadrupole centers <o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>quadcenterall;<span
style=3D'mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%
Data saved to &lt;DataRoot&gt;\QMS with filename<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:135.0pt;text-indent:9.0pt'><span
style=3D'font-family:Arial'>% determined by date and time<o:p></o:p></span>=
</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Save the new centers to the default offset orbit<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>How this is done depends =
on the
accelerators.<span style=3D'mso-spacerun:yes'>&nbsp; </span>Ultimately the
AO.BPMx.Golden field needs to be set properly.<span
style=3D'mso-spacerun:yes'>&nbsp; </span>quadplotall is often used to plot =
the
offset information after the whole accelerator is measured.<span
style=3D'mso-spacerun:yes'>&nbsp; </span>Use quadplot to check any individu=
al
quadrupole center.<span style=3D'mso-spacerun:yes'>&nbsp; </span>At Spear t=
he
offset orbit is saved in the spear3physdata file and loaded into the AO by
spear3init.<span style=3D'mso-spacerun:yes'>&nbsp; </span>Hence, at Spear to
change to a new offset orbit put all the quadrupole center files in one
directory and run:</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>[x,
y] =3D quadplotall([]);<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>setphysdata('BPMx',
'Offset', x(:,3), x(:,1:2));<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>setphysdata('BPMy',
'Offset', y(:,3), y(:,1:2));<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>Then rerun spear3init.<sp=
an
style=3D'mso-spacerun:yes'>&nbsp; </span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>At the ALS changes to the=
 golden
and offset orbits are made in setoperationalmode.<span
style=3D'mso-spacerun:yes'>&nbsp; </span>At the CLS the golden and offset a=
re
stored in a file and loaded from clsinit.</p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;text-indent:-27.0pt;mso-li=
st:l6 level1 lfo1;
tab-stops:list 27.0pt'><![if !supportLists]><b style=3D'mso-bidi-font-weigh=
t:
normal'><span style=3D'font-size:14.0pt'><span style=3D'mso-list:Ignore'>16=
.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </spa=
n></span></span></b><![endif]><b
style=3D'mso-bidi-font-weight:normal'><span style=3D'font-size:14.0pt'>Mode=
l only
functions<o:p></o:p></span></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'>A number of function have=
 been
written only to get or set model parameters.</p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Model dispersion function<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>modeldisp;<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style=3D'mso-tab-count:1'> </span>% Plots with units mm/MHz<o:=
p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>modeldisp('BPMx',
'BPMy');<span style=3D'mso-tab-count:1'>&nbsp;&nbsp; </span>% Plots at 'BPM=
x',
'BPMy' families [mm/MHz]<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>modeldisp('Physics');<span
style=3D'mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%
Plots with units meters/(dp/p)<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>[Dx,
Dy] =3D modeldisp;<span style=3D'mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%
Returns Dx, Dy with units mm/MHz<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Model beta function<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>modeltwiss('beta');<span
style=3D'mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%
Plot beta<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>modeltwiss('beta',
'BPMx');<span style=3D'mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%
Plot beta at the BPMx family<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>[Betax,
Betay] =3D modeltwiss('beta', 'BPMx');<span style=3D'mso-spacerun:yes'>&nbs=
p;&nbsp;
</span>% Returns beta at BPMx<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Model closed orbit<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>[x,
y] =3D modeltwiss('ClosedOrbit');<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>% Closed orbit at all =
AT
elements<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>[x,
y] =3D modeltwiss('x');<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>% Closed orbit at all AT elements<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>y
=3D modeltwiss('y', 'BPMy');<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>% Vertical orbit at BPMy family<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span
style=3D'mso-spacerun:yes'>&nbsp;</span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
RF Cavity and Radiation<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>setcavity
on;<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>setcavity
off;<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>setradiation
on;<span style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp; </span>%
It is interesting to check the orbit changes<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>setradiation
off;<span style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%
due to energy changes due to radiation<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;text-indent:-27.0pt;mso-li=
st:l6 level1 lfo1;
tab-stops:list 27.0pt'><![if !supportLists]><b style=3D'mso-bidi-font-weigh=
t:
normal'><span style=3D'font-size:14.0pt'><span style=3D'mso-list:Ignore'>17=
.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </spa=
n></span></span></b><![endif]><b
style=3D'mso-bidi-font-weight:normal'><span style=3D'font-size:14.0pt'>Exam=
ple
Script (Orbit Correction)<o:p></o:p></span></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Introduce an orbit error (10 microradian)<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>setsp('HCM',
10e-6*randn(size(family2dev('HCM'),1),1), 'Physics');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Get the horizontal response matrix<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Use the Model<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>Sx
=3D measbpmresp('Struct', 'Model');<span style=3D'mso-tab-count:1'>&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:=
p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>Sx
=3D Sx(1,1).Data;<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Or use the Default<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>Sx
=3D getrespmat('BPMx','HCM');<span style=3D'mso-tab-count:1'>&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Gets all horizontal BPMs (vector)<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>X
=3D getx;<span style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Computes the SVD of the response matrix<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Use singular vectors 1 thru 60<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>Ivec
=3D 1:60;<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>[U,
S, V] =3D svd(Sx);<span style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp; </span><o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Find the corrector changes (vector)<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>DeltaAmps
=3D -V(:,Ivec)*((U(:,Ivec)*S(Ivec,Ivec))\X) ;<span style=3D'mso-tab-count:1=
'> </span><o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Changes the current in all horizontal corrector magnets<o:p></o:p></span></=
p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>stepsp('HCM',
DeltaAmps);<span style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span><o:p><=
/o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>%
Plot new orbit<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>plot(getspos('BPMx'),
X, 'b', getspos('BPMx'), getx, 'r');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>xlabel('BPM
Position [meters]');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'mso-bidi-f=
ont-size:
14.0pt;font-family:Arial'>legend('Before', 'After');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'mso-bidi-f=
ont-size:
14.0pt;font-family:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'mso-bidi-f=
ont-size:
14.0pt;font-family:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;text-indent:-27.0pt;mso-li=
st:l6 level1 lfo1;
tab-stops:list 27.0pt'><![if !supportLists]><b style=3D'mso-bidi-font-weigh=
t:
normal'><span style=3D'font-size:14.0pt'><span style=3D'mso-list:Ignore'>18=
.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </spa=
n></span></span></b><![endif]><b
style=3D'mso-bidi-font-weight:normal'><span style=3D'font-size:14.0pt'>Error
Handling<o:p></o:p></span></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>In
general, error handling in Matlab is done with try;catch statements.<span
style=3D'mso-spacerun:yes'>&nbsp; </span>However, some middle layer users p=
refer
Setpoint &#8211; Monitor errors to behave differently. <span
style=3D'mso-spacerun:yes'>&nbsp;</span>Hence a middle layer family variabl=
e can
be set to change what happen on a SP-AM error.<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;tab-stops:2.25in'><span
style=3D'font-family:Arial'>AD.ErrorWarningLevel =3D<span style=3D'mso-tab-=
count:
1'>&nbsp;&nbsp; </span> 0 SP-AM errors are a Matlab errors {Default}<o:p></=
o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;tab-stops:2.25in'><span
style=3D'font-family:Arial'><span style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp; </span>-1
SP-AM errors are a Matlab warnings<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;tab-stops:2.25in'><span
style=3D'font-family:Arial'><span style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp; </span>-2
SP-AM errors prompt a dialog box<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;tab-stops:2.25in'><span
style=3D'font-family:Arial'><span style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp; </span>-3
SP-AM errors are ignored<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'mso-bidi-f=
ont-size:
14.0pt;font-family:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'mso-bidi-f=
ont-size:
14.0pt;font-family:Arial'>To get the warning level:<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>ErrorWarningLevel
=3D getfamilydata('ErrorWarningLevel');<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'mso-bidi-f=
ont-size:
14.0pt;font-family:Arial'>To set the warning level:<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>setfamilydata(ErrorWarningLevel
, 'ErrorWarningLevel');</span><span style=3D'mso-bidi-font-size:14.0pt;
font-family:Arial'><o:p></o:p></span></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>Note
that many functions have try;catch statements to catch errors.<span
style=3D'mso-spacerun:yes'>&nbsp; </span>Only when the ErrorWarningLevel is=
 0
will these statement be used to catch SP-AM errors.<span
style=3D'mso-spacerun:yes'>&nbsp; </span><o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>Changing
the default </span><span style=3D'mso-bidi-font-size:14.0pt;font-family:Ari=
al'>warning
level</span><span style=3D'font-family:Arial'> for an accelerator is usuall=
y done
in the setoperationalmode function.<span style=3D'mso-spacerun:yes'>&nbsp;
</span><o:p></o:p></span></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt;text-indent:-27.0pt;mso-li=
st:l6 level1 lfo1;
tab-stops:list 27.0pt'><![if !supportLists]><b style=3D'mso-bidi-font-weigh=
t:
normal'><span style=3D'font-size:14.0pt'><span style=3D'mso-list:Ignore'>19=
.<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </spa=
n></span></span></b><![endif]><b
style=3D'mso-bidi-font-weight:normal'><span style=3D'font-size:14.0pt'>Setp=
oint
&#8211; Monitor Tolerance<o:p></o:p></span></b></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'mso-bidi-f=
ont-size:
14.0pt;font-family:Arial'>Determining whether or not a magnet (or other
devices) are ramping is often done by comparing the setpoint to the monitor
value and seeing if it&#8217;s within a tolerance band.<span
style=3D'mso-spacerun:yes'>&nbsp; </span>Some<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'mso-bidi-f=
ont-size:
14.0pt;font-family:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'mso-bidi-f=
ont-size:
14.0pt;font-family:Arial'>To get the tolerance:<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>Tol
=3D getfamilydata(Family, 'Setpoint', 'Tolerance', DeviceList);<o:p></o:p><=
/span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><span
style=3D'mso-spacerun:yes'>&nbsp; </span>or<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>Tol
=3D family2tol(Family, DeviceList);<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'mso-bidi-f=
ont-size:
14.0pt;font-family:Arial'>To set the tolerance:<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>setfamilydata(Tol,
Family, 'Setpoint', 'Tolerance', DeviceList);<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'>Permanently
changing the tolerance field is done in the initialization file.<span
style=3D'mso-spacerun:yes'>&nbsp; </span><o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><span style=3D'font-famil=
y:Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'margin-left:27.0pt'><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>

------=_NextPart_01C781C0.6598B8C0
Content-Location: file:///C:/515444C5/MiddleLayerQuickReference_files/header.htm
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html; charset="us-ascii"

<html xmlns:v=3D"urn:schemas-microsoft-com:vml"
xmlns:o=3D"urn:schemas-microsoft-com:office:office"
xmlns:w=3D"urn:schemas-microsoft-com:office:word"
xmlns:st1=3D"urn:schemas-microsoft-com:office:smarttags"
xmlns=3D"http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=3DContent-Type content=3D"text/html; charset=3Dus-ascii">
<meta name=3DProgId content=3DWord.Document>
<meta name=3DGenerator content=3D"Microsoft Word 11">
<meta name=3DOriginator content=3D"Microsoft Word 11">
<link id=3DMain-File rel=3DMain-File href=3D"../MiddleLayerQuickReference.h=
tm">
<![if IE]>
<base href=3D"file:///C:\515444C5\MiddleLayerQuickReference_files\header.ht=
m"
id=3D"webarch_temp_base_tag">
<![endif]><o:SmartTagType
 namespaceuri=3D"urn:schemas-microsoft-com:office:smarttags" name=3D"place"=
/>
<o:SmartTagType namespaceuri=3D"urn:schemas-microsoft-com:office:smarttags"
 name=3D"State"/>
<o:SmartTagType namespaceuri=3D"urn:schemas-microsoft-com:office:smarttags"
 name=3D"PlaceType"/>
<o:SmartTagType namespaceuri=3D"urn:schemas-microsoft-com:office:smarttags"
 name=3D"PlaceName"/>
</head>

<body lang=3DEN-US>

<div style=3D'mso-element:footnote-separator' id=3Dfs>

<p class=3DMsoNormal><span style=3D'mso-special-character:footnote-separato=
r'><![if !supportFootnotes]>

<hr align=3Dleft size=3D1 width=3D"33%">

<![endif]></span></p>

</div>

<div style=3D'mso-element:footnote-continuation-separator' id=3Dfcs>

<p class=3DMsoNormal><span style=3D'mso-special-character:footnote-continua=
tion-separator'><![if !supportFootnotes]>

<hr align=3Dleft size=3D1>

<![endif]></span></p>

</div>

<div style=3D'mso-element:endnote-separator' id=3Des>

<p class=3DMsoNormal><span style=3D'mso-special-character:footnote-separato=
r'><![if !supportFootnotes]>

<hr align=3Dleft size=3D1 width=3D"33%">

<![endif]></span></p>

</div>

<div style=3D'mso-element:endnote-continuation-separator' id=3Decs>

<p class=3DMsoNormal><span style=3D'mso-special-character:footnote-continua=
tion-separator'><![if !supportFootnotes]>

<hr align=3Dleft size=3D1>

<![endif]></span></p>

</div>

<div style=3D'mso-element:footer' id=3Def1>

<div style=3D'mso-element:frame;mso-element-wrap:around;mso-element-anchor-=
vertical:
paragraph;mso-element-anchor-horizontal:margin;mso-element-left:center;
mso-element-top:.05pt;mso-height-rule:exactly'>

<table cellspacing=3D0 cellpadding=3D0 hspace=3D0 vspace=3D0 align=3Dcenter>
 <tr>
  <td valign=3Dtop align=3Dleft style=3D'padding-top:0in;padding-right:0in;
  padding-bottom:0in;padding-left:0in'>
  <p class=3DMsoFooter style=3D'mso-element:frame;mso-element-wrap:around;
  mso-element-anchor-vertical:paragraph;mso-element-anchor-horizontal:margi=
n;
  mso-element-left:center;mso-element-top:.05pt;mso-height-rule:exactly'><!=
--[if supportFields]><span
  class=3DMsoPageNumber><span style=3D'mso-element:field-begin'></span>PAGE=
<span
  style=3D'mso-spacerun:yes'>&nbsp; </span></span><![endif]--><!--[if suppo=
rtFields]><span
  class=3DMsoPageNumber><span style=3D'mso-element:field-end'></span></span=
><![endif]--><span
  class=3DMsoPageNumber><o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=3DMsoFooter><o:p>&nbsp;</o:p></p>

</div>

<div style=3D'mso-element:footer' id=3Df1>

<div style=3D'mso-element:frame;mso-element-wrap:around;mso-element-anchor-=
vertical:
paragraph;mso-element-anchor-horizontal:margin;mso-element-left:center;
mso-element-top:.05pt;mso-height-rule:exactly'>

<table cellspacing=3D0 cellpadding=3D0 hspace=3D0 vspace=3D0 align=3Dcenter>
 <tr>
  <td valign=3Dtop align=3Dleft style=3D'padding-top:0in;padding-right:0in;
  padding-bottom:0in;padding-left:0in'>
  <p class=3DMsoFooter style=3D'mso-element:frame;mso-element-wrap:around;
  mso-element-anchor-vertical:paragraph;mso-element-anchor-horizontal:margi=
n;
  mso-element-left:center;mso-element-top:.05pt;mso-height-rule:exactly'><!=
--[if supportFields]><span
  class=3DMsoPageNumber><span style=3D'mso-element:field-begin'></span>PAGE=
<span
  style=3D'mso-spacerun:yes'>&nbsp; </span><span style=3D'mso-element:field=
-separator'></span></span><![endif]--><span
  class=3DMsoPageNumber><span style=3D'mso-no-proof:yes'>1</span></span><!-=
-[if supportFields]><span
  class=3DMsoPageNumber><span style=3D'mso-element:field-end'></span></span=
><![endif]--><span
  class=3DMsoPageNumber><o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=3DMsoFooter><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>

------=_NextPart_01C781C0.6598B8C0
Content-Location: file:///C:/515444C5/MiddleLayerQuickReference_files/filelist.xml
Content-Transfer-Encoding: quoted-printable
Content-Type: text/xml; charset="utf-8"

<xml xmlns:o=3D"urn:schemas-microsoft-com:office:office">
 <o:MainFile HRef=3D"../MiddleLayerQuickReference.htm"/>
 <o:File HRef=3D"header.htm"/>
 <o:File HRef=3D"filelist.xml"/>
</xml>
------=_NextPart_01C781C0.6598B8C0--
