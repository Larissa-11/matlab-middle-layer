<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of updateatindex</title>
  <meta name="keywords" content="updateatindex">
  <meta name="description" content="UPDATEATINDEX - Updates the AT indices in the MiddleLayer with the present AT lattice">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">machine</a> &gt; <a href="#">VUV</a> &gt; <a href="index.html">800MeV</a> &gt; updateatindex.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for machine\VUV\800MeV&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>updateatindex
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>UPDATEATINDEX - Updates the AT indices in the MiddleLayer with the present AT lattice</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function updateatindex </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">UPDATEATINDEX - Updates the AT indices in the MiddleLayer with the present AT lattice</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="setoperationalmode.html" class="code" title="function setoperationalmode(OperationalMode)">setoperationalmode</a>	SETOPERATIONALMODE - Switches between the various operational modes</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function updateatindex</a>
0002 <span class="comment">%UPDATEATINDEX - Updates the AT indices in the MiddleLayer with the present AT lattice</span>
0003 
0004 
0005 <span class="keyword">global</span> THERING
0006 
0007 
0008 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0009 <span class="comment">% Append Accelerator Toolbox information %</span>
0010 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0011 
0012 <span class="comment">% Since changes in the AT model could change the AT indexes, etc,</span>
0013 <span class="comment">% It's best to regenerate all the model indices whenever a model is loaded</span>
0014 
0015 AO = getao;
0016 
0017 <span class="comment">%BPMS</span>
0018 AO.BPMx.AT.ATType  = <span class="string">'X'</span>;
0019 AO.BPMx.AT.ATIndex = findcells(THERING,<span class="string">'FamName'</span>,<span class="string">'BPM'</span>)';
0020 
0021 AO.BPMy.AT.ATType  = <span class="string">'Y'</span>;
0022 AO.BPMy.AT.ATIndex = findcells(THERING,<span class="string">'FamName'</span>,<span class="string">'BPM'</span>)';
0023 
0024 <span class="comment">%CORRECTORS</span>
0025 AO.HCM.AT.ATType  = <span class="string">'HCM'</span>;
0026 AO.HCM.AT.ATIndex = buildatindex(AO.HCM.FamilyName, <span class="string">'HCOR'</span>);
0027 
0028 AO.VCM.AT.ATType = <span class="string">'VCM'</span>;
0029 AO.VCM.AT.ATIndex = buildatindex(AO.VCM.FamilyName, <span class="string">'VCOR'</span>);
0030 
0031 <span class="comment">%QUADRUPOLES</span>
0032 AO.Q1.AT.ATType = <span class="string">'QUAD'</span>;
0033 AO.Q1.AT.ATIndex = buildatindex(AO.Q1.FamilyName, <span class="string">'Q1'</span>);
0034 AO.Q2.AT.ATType = <span class="string">'QUAD'</span>;
0035 AO.Q2.AT.ATIndex = buildatindex(AO.Q2.FamilyName, <span class="string">'Q2'</span>);
0036 AO.Q3.AT.ATType = <span class="string">'QUAD'</span>;
0037 AO.Q3.AT.ATIndex = buildatindex(AO.Q3.FamilyName, <span class="string">'Q3'</span>);
0038 AO.Q4.AT.ATType = <span class="string">'QUAD'</span>;
0039 AO.Q4.AT.ATIndex = buildatindex(AO.Q4.FamilyName, <span class="string">'Q4'</span>);
0040 AO.Q5.AT.ATType = <span class="string">'QUAD'</span>;
0041 AO.Q5.AT.ATIndex = buildatindex(AO.Q5.FamilyName, <span class="string">'Q5'</span>);
0042 AO.Q6.AT.ATType = <span class="string">'QUAD'</span>;
0043 AO.Q6.AT.ATIndex = buildatindex(AO.Q6.FamilyName, <span class="string">'Q6'</span>);
0044 AO.Q7.AT.ATType = <span class="string">'QUAD'</span>;
0045 AO.Q7.AT.ATIndex = buildatindex(AO.Q7.FamilyName, <span class="string">'Q7'</span>);
0046 
0047 <span class="comment">%SEXTUPOLES</span>
0048 AO.SF.AT.ATType = <span class="string">'SEXT'</span>;
0049 AO.SF.AT.ATIndex = buildatindex(AO.SF.FamilyName, <span class="string">'SF'</span>);
0050 
0051 AO.SD.AT.ATType = <span class="string">'SEXT'</span>;
0052 AO.SD.AT.ATIndex = buildatindex(AO.SD.FamilyName, <span class="string">'SD'</span>);
0053 
0054 <span class="comment">% BEND</span>
0055 AO.BEND.AT.ATType = <span class="string">'BEND'</span>;
0056 AO.BEND.AT.ATIndex = buildatindex(AO.BEND.FamilyName, <span class="string">'BEND'</span>);
0057 
0058 <span class="comment">%RF</span>
0059 AO.RF.AT.ATType = <span class="string">'RF'</span>;
0060 AO.RF.AT.ATIndex = findcells(THERING,<span class="string">'FamName'</span>,<span class="string">'RF'</span>)';
0061 
0062 
0063 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
0064 <span class="comment">% Get S-positions %</span>
0065 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
0066 AO.BPMx.Position = findspos(THERING, AO.BPMx.AT.ATIndex)';
0067 AO.BPMy.Position = findspos(THERING, AO.BPMy.AT.ATIndex)';
0068 
0069 AO.HCM.Position = findspos(THERING, AO.HCM.AT.ATIndex)';
0070 AO.VCM.Position = findspos(THERING, AO.VCM.AT.ATIndex)';
0071 
0072 AO.Q1.Position = findspos(THERING, AO.Q1.AT.ATIndex)';
0073 AO.Q2.Position = findspos(THERING, AO.Q2.AT.ATIndex)';
0074 AO.Q3.Position = findspos(THERING, AO.Q3.AT.ATIndex)';
0075 AO.Q4.Position = findspos(THERING, AO.Q4.AT.ATIndex)';
0076 AO.Q5.Position = findspos(THERING, AO.Q5.AT.ATIndex)';
0077 AO.Q6.Position = findspos(THERING, AO.Q6.AT.ATIndex)';
0078 AO.Q7.Position = findspos(THERING, AO.Q7.AT.ATIndex)';
0079 
0080 AO.SF.Position = findspos(THERING, AO.SF.AT.ATIndex)';
0081 AO.SD.Position = findspos(THERING, AO.SD.AT.ATIndex)';
0082 
0083 <span class="comment">% RF may not be in the AT model</span>
0084 <span class="keyword">if</span> isempty(AO.RF.AT.ATIndex)
0085     AO.RF.Position = 0;
0086 <span class="keyword">else</span>
0087     AO.RF.Position = findspos(THERING, AO.RF.AT.ATIndex)';
0088 <span class="keyword">end</span>
0089 
0090 
0091 setao(AO);
0092 
0093 
0094 
0095 <span class="comment">% Set TwissData at the start of the storage ring</span>
0096 <span class="keyword">try</span>
0097     
0098     <span class="comment">% BTS twiss parameters at the input</span>
0099     TwissData.alpha = [0 0]';
0100     TwissData.beta  = [13.3155 6.6688]';
0101     TwissData.mu    = [0 0]';
0102     TwissData.ClosedOrbit = [0 0 0 0]';
0103     TwissData.dP = 0;
0104     TwissData.dL = 0;
0105     TwissData.Dispersion  = [0.0455 0 0 0]';
0106     
0107     setpvmodel(<span class="string">'TwissData'</span>, <span class="string">''</span>, TwissData);  <span class="comment">% Same as, THERING{1}.TwissData = TwissData;</span>
0108 
0109 <span class="keyword">catch</span>
0110      warning(<span class="string">'Setting the twiss data parameters in the MML failed.'</span>);
0111 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Fri 01-Aug-2008 10:57:33 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>